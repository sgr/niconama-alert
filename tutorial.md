---
layout: default
title: niconama-alert.clj tutorial
---

* auto-gen TOC:
{:toc}

#初めての起動{#boot_initially}

初めて起動するとこのようなウィンドウが表示されます。

![初めての起動画面]({{ site.baseurl }}/images/sc_init.png)

ウィンドウ下部右のRSSボタンを押してみましょう。
すると番組情報の取得が開始されます。ステータスバーが右端に達すると取得終了です。

![RSSボタンを押してみよう]({{ site.baseurl }}/images/sc_rss_btn.png)


#検索してみよう{#search_basic}

番組情報は取得されています。この中から検索してみます。"Search"タブを表示してみましょう。

![Searchタブ]({{ site.baseurl }}/images/sc_search_tab.png)

* 左側の"Search target"で検索対象を選びましょう。ここでは"Title"をチェックします。
* 右側の"Search condition"に検索したい番組タイトルに含まれていそうな単語を入力します。
  ここでは"実況"を入れてみます。
* 検索条件を入力するとウィンドウ中央の"Search"ボタンが有効になります。
  押して検索してみましょう。

![検索例]({{ site.baseurl }}/images/sc_search.png)

検索結果は表示されたでしょうか？検索結果は時々刻々変わります。1件も得られなかった場合は他の言葉でも検索してみましょう。


#検索条件をチャンネルとして残す{#save_as_channel}

この検索条件を毎回入力しなくてもいいよう、チャンネルとして保存します。
"Search"ボタンの隣に"save as keyword ch"ボタンがあります。
このボタンを押すと、チャンネルのタイトルを入力するタブが表示されます。
ここでは"実況"と入力し、"OK"ボタンを押します。

![キーワードチャンネルタイトル入力]({{ site.baseurl }}/images/sc_add_kwd_ch.png)

では"Listings"タブに戻ってみましょう。
すると先ほど入力した検索条件を持ったチャンネルが一列追加されているはずです。
これで毎回検索しなくてもよくなりました。

![キーワードチャンネル追加後]({{ site.baseurl }}/images/sc_added_kwd_ch.png)

また、"Alert"チェックを入れると、新しい番組が追加されるたびにデスクトップ上にアラートを表示します。


#ログインしてみよう{#login}

ニコニコ動画のアカウントを持っている場合、そのアカウントでログインすることでアカウントのチャンネルが追加されます。
"Channel"メニューから"Add user channel"を選択します。

![ユーザーチャンネル追加メニュー]({{ site.baseurl }}/images/sc_add_user_ch_menu.png)

すると、ログイン情報入力ダイアログが表示されます。
ここにニコニコ動画のログイン情報を入力し、"OK"ボタンを押します。

![ログイン情報入力ダイアログ]({{ site.baseurl }}/images/sc_login_dlg.png)

すると、"Listings"タブに先ほどと同様にもう一列番組表が追加されているはずです。
ここにはそのアカウントが登録しているコミュニティの現在の番組が表示されます。

また、有効なアカウントがログインすることでニコ生アラートAPIを使ったリアルタイム番組情報取得が可能になります。
ログインするとウィンドウ下部中央のAPIボタンを押せるようになります。


#詳細な検索条件を書いてみよう{#search_advanced}

さて、上述のような手順を経て実際にniconama-alert.cljを使いはじめると、
番組表に表示される番組が自分のほしいものと異なることがあります。

そのような時は検索条件を見なおしてみましょう。
新しく検索を行う場合は"Search"タブで行いますが、既にあるキーワードチャンネルの検索条件を変更する場合は
番組表上部の歯車ボタンを押すと、次のような検索条件ダイアログが表示されます。

![検索条件ダイアログ]({{ site.baseurl }}/images/sc_ss_dlg.png)

以降の節では"Search"タブまたは検索条件ダイアログの"Search Condition"の詳細な記述方法を説明します。



##いずれかの単語を含む番組を検索する(or){#search_or}

[検索してみよう](#search_basic) では単語を増やすことは全ての単語を含んだものを検索する、すなわち絞り込みを意味していました。
逆に広げたい、例えば入力した単語のうちいずれか一つでも含んでいればよい、という条件にしたい場合は次のように記述します。

{% highlight lisp %}
(or "MLB" "Major League Baseball" "メジャー" "大リーグ")
{% endhighlight %}

このように記述すると、「MLB」や「大リーグ」のみを含んだものも検索されるようになります。
単語の前後が括弧でくくられ、前方の括弧の後に"or"がつくようになりました。


###単語の表記に関する注意{#notice_word}

* このページの例では各単語を""で囲んでいますが、niconama-alert.cljでは囲まずに書いても構いません。
  ただし、"Major League Baseball"のように空白を含んだ語をひとかたまりに扱ってほしい場合は囲む必要があります。
  このチュートリアルでは正式な記述として語は""で囲んでいます。
* 英単語において、大文字小文字は区別されません。"MLB"と書いても"mlb"と書いても同じように扱われます。
  ただし、いわゆる全角と半角は区別されます。両方を指定する場合はor条件で列挙することになります。


##全ての単語を含む番組を検索する(and){#search_and}

実は上の [いずれかの単語を含む番組を検索する(or)](#search_or) で紹介した括弧を使った書き方が正式な検索条件の記述方法です。
[検索してみよう](#search_basic) で紹介した単語を列挙する記述方法は次の絞り込み条件の簡略記法です。

単語の列挙による絞り込み条件を正式に記述すると次のようになります。

{% highlight lisp %}
(and "阪神" "タイガース")
{% endhighlight %}

このようにorやandを補うことによって、自分のほしい情報をより正確に表現することができるようになります。


##条件の組み合わせを試してみよう{#complex_cond}

なぜ正式な検索条件記述では括弧を用いるのでしょうか？
それは、括弧でくくることでandやorの対象や及ぶ範囲が明確になるためです[^prefix_notation]。

[^prefix_notation]: なお、andやorを前方に配する書き方を前置記法といいます。一方「ハム or ビーフジャーキー or ソーセージ or サラミ or ミミガー」のような書き方を中置記法といいます。この例からもわかるように、前置記法のメリットは簡潔さです。また明示的な括弧を要求する記法でもあるため、括弧を省略可能な中置記法で問題となる演算子の優先度に悩むこともありません。

例えば次のような全体としてはandで絞り込む形にしつつ、個々の単語の表記揺れをorで記述するような
andとorの組み合わせはよく行われます[^qe]。

[^qe]: niconama-alert.cljには表記ゆれを補うクエリ拡張や形態素解析機能はありません。そのため特に動詞のように語幹だけの検索ではノイズが多い場合は活用語尾を補ったパターンをorで列挙する書き方になってしまいます。

{% highlight lisp %}
(and (or "RTA" "リアルタイムアタック") (or "RPG" "ロールプレイングゲーム" "ロープレ"))
{% endhighlight %}


##条件をひっくり返す(not){#search_not}

特にorを使って検索を行っていると、検索結果に自分の興味のないものがいくつも含まれることがあります。
ほしいものを正確に限定できるならandで絞り込むことができますが、逆に要らないものだけは限定できる、という場合もあるでしょう。

そのような場合は次のように記述します。

{% highlight lisp %}
(and "野球" (not "巨人"))
{% endhighlight %}

notはandやorと異なり、その後ろに一つだけ条件をつけ、その条件を検索結果から除きます。
ですので、例えば「巨人」だけでなく「ジャイアンツ」も不要な場合は次のように記述します。

{% highlight lisp %}
(and "野球" (not (or "巨人" "ジャイアンツ")))
{% endhighlight %}

